<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>数据库课程设计 | Wei's blog</title><meta name="author" content="Wei"><meta name="copyright" content="Wei"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="一个简单的员工管理系统">
<meta property="og:type" content="article">
<meta property="og:title" content="数据库课程设计">
<meta property="og:url" content="http://yiweibu.github.io/2024/08/06/ems_db/index.html">
<meta property="og:site_name" content="Wei&#39;s blog">
<meta property="og:description" content="一个简单的员工管理系统">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yiweibu.github.io/imgs/tx.jpg">
<meta property="article:published_time" content="2024-08-05T16:00:00.000Z">
<meta property="article:modified_time" content="2024-08-06T03:14:52.735Z">
<meta property="article:author" content="Wei">
<meta property="article:tag" content="sql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yiweibu.github.io/imgs/tx.jpg"><link rel="shortcut icon" href="/imgs/wt.jpg"><link rel="canonical" href="http://yiweibu.github.io/2024/08/06/ems_db/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '数据库课程设计',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-08-06 11:14:52'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/imgs/tx.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr class="custom-hr"/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/imgs/bg.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Wei's blog"><span class="site-name">Wei's blog</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">数据库课程设计</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-08-05T16:00:00.000Z" title="发表于 2024-08-06 00:00:00">2024-08-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-08-06T03:14:52.735Z" title="更新于 2024-08-06 11:14:52">2024-08-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AF%BE%E8%AE%BE/">课设</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="数据库课程设计"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="数据库实验报告"><a href="#数据库实验报告" class="headerlink" title="数据库实验报告"></a>数据库实验报告</h1><h2 id="小实验：SQL基本操作"><a href="#小实验：SQL基本操作" class="headerlink" title="小实验：SQL基本操作"></a>小实验：SQL基本操作</h2><h3 id="实验一：搭建环境"><a href="#实验一：搭建环境" class="headerlink" title="实验一：搭建环境"></a>实验一：搭建环境</h3><p>成功搭建mysql环境</p>
<h3 id="实验二"><a href="#实验二" class="headerlink" title="实验二"></a>实验二</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database Demo;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> Demo.customer(customid <span class="type">varchar</span>(<span class="number">17</span>) <span class="keyword">primary</span> key,name <span class="type">varchar</span>(<span class="number">10</span>),sex <span class="type">varchar</span>(<span class="number">2</span>),age <span class="type">int</span>(<span class="number">4</span>),xfg <span class="type">dec</span>(<span class="number">10</span>,<span class="number">2</span>),address <span class="type">varchar</span>(<span class="number">50</span>),joindate <span class="type">date</span>,memo <span class="type">varchar</span>(<span class="number">100</span>));</span><br></pre></td></tr></table></figure>

<h3 id="实验三"><a href="#实验三" class="headerlink" title="实验三"></a>实验三</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> Demo.student(id <span class="type">varchar</span>(<span class="number">17</span>),name <span class="type">varchar</span>(<span class="number">10</span>),sex <span class="type">varchar</span>(<span class="number">2</span>),age <span class="type">integer</span>,score <span class="type">numeric</span>(<span class="number">6</span>,<span class="number">2</span>),joindate <span class="type">date</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Demo.student(id,name,sex,age,score,joindate) </span><br><span class="line"><span class="keyword">values</span>(&quot;A0001&quot;,&quot;赵一&quot;,&quot;男&quot;,<span class="number">20</span>,<span class="number">580.00</span>,<span class="type">date</span>(<span class="string">&#x27;2020-9-1&#x27;</span>)),(&quot;B0002&quot;,&quot;钱二&quot;,&quot;女&quot;,<span class="number">19</span>,<span class="number">540.00</span>,<span class="type">date</span>(<span class="string">&#x27;2021-9-1&#x27;</span>)),</span><br><span class="line">(&quot;C0003&quot;,&quot;孙三&quot;,&quot;男&quot;,<span class="number">21</span>,<span class="number">555.50</span>,<span class="type">date</span>(<span class="string">&#x27;2020-8-30&#x27;</span>)),(&quot;D0004&quot;,&quot;李四&quot;,&quot;男&quot;,<span class="number">22</span>,<span class="number">480.00</span>,<span class="type">date</span>(<span class="string">&#x27;2021-9-2&#x27;</span>)),</span><br><span class="line">(&quot;E0005&quot;,&quot;周五&quot;,&quot;女&quot;,<span class="number">20</span>,<span class="number">495.50</span>,<span class="type">date</span>(<span class="string">&#x27;2022-7-30&#x27;</span>)),(&quot;F0006&quot;,&quot;吴六&quot;,&quot;男&quot;,<span class="number">19</span>,<span class="number">435.00</span>,<span class="type">date</span>(<span class="string">&#x27;2021-9-1&#x27;</span>));</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Demo.student <span class="keyword">where</span> age<span class="operator">&gt;=</span><span class="number">20</span> <span class="keyword">and</span> score<span class="operator">&lt;</span><span class="number">500</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">year</span>(joindate),<span class="built_in">count</span>(id) <span class="keyword">from</span> Demo.student <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">year</span>(joindate); </span><br></pre></td></tr></table></figure>

<h3 id="实验四"><a href="#实验四" class="headerlink" title="实验四"></a>实验四</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> Demo.test(id <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">primary</span> key,name <span class="type">varchar</span>(<span class="number">20</span>),age <span class="type">int</span>(<span class="number">4</span>));</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> Demo.test;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> Demo.test(id <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">primary</span> key,name <span class="type">varchar</span>(<span class="number">20</span>),age <span class="type">int</span>(<span class="number">4</span>));</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> Demo.test change name test_name <span class="type">varchar</span>(<span class="number">21</span>);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> Demo.test <span class="keyword">add</span> email <span class="type">varchar</span>(<span class="number">100</span>);</span><br><span class="line"><span class="keyword">create</span> index idx_name <span class="keyword">on</span> Demo.test(test_name,email);</span><br><span class="line"><span class="keyword">drop</span> index idx_name <span class="keyword">on</span> Demo.test;</span><br><span class="line"><span class="keyword">create</span> index idx_id <span class="keyword">on</span> Demo.test(id <span class="keyword">desc</span>);</span><br><span class="line"><span class="keyword">drop</span> index idx_id <span class="keyword">on</span> Demo.test;</span><br></pre></td></tr></table></figure>

<h3 id="实验五"><a href="#实验五" class="headerlink" title="实验五"></a>实验五</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Demo.cc (</span><br><span class="line">    Cc1 <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    Cc2 <span class="type">INT</span>,</span><br><span class="line">    Cc3 <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>),</span><br><span class="line">    Cc4 <span class="type">VARCHAR</span>(<span class="number">100</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Demo.cc (Cc1, Cc2, Cc3, Cc4) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">&#x27;赵一&#x27;</span>, <span class="number">20</span>, <span class="number">580.00</span>, <span class="string">&#x27;重邮宿舍12-3-5&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;钱二&#x27;</span>, <span class="number">19</span>, <span class="number">540.00</span>, <span class="string">&#x27;南福苑5-2-9&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;孙三&#x27;</span>, <span class="number">21</span>, <span class="number">555.50</span>, <span class="string">&#x27;学生新区21-5-15&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;李四&#x27;</span>, <span class="number">22</span>, <span class="number">480.00</span>, <span class="string">&#x27;重邮宿舍8-2-22&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;周五&#x27;</span>, <span class="number">20</span>, <span class="number">495.50</span>, <span class="string">&#x27;学生新区23-4-8&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;吴六&#x27;</span>, <span class="number">19</span>, <span class="number">435.00</span>, <span class="string">&#x27;南福苑2-5-12&#x27;</span>);</span><br><span class="line"><span class="keyword">SET</span> SQL_SAFE_UPDATES <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> Demo.cc <span class="keyword">SET</span> cc3 <span class="operator">=</span> cc3 <span class="operator">+</span> <span class="number">5</span> <span class="keyword">WHERE</span> cc2 <span class="operator">&lt;=</span> <span class="number">20</span>;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> Demo.cc <span class="keyword">WHERE</span> cc2 <span class="operator">&gt;=</span> <span class="number">20</span> <span class="keyword">AND</span> cc3 <span class="operator">&gt;=</span> <span class="number">500</span>;</span><br></pre></td></tr></table></figure>

<h3 id="实验六"><a href="#实验六" class="headerlink" title="实验六"></a>实验六</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> Demo.student;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Demo.Student (</span><br><span class="line">    ID <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    Name <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">    Age <span class="type">INT</span>,</span><br><span class="line">    Department <span class="type">VARCHAR</span>(<span class="number">30</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> Demo.Course;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Demo.Course (</span><br><span class="line">    CourseID <span class="type">VARCHAR</span>(<span class="number">15</span>) <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    CourseName <span class="type">VARCHAR</span>(<span class="number">30</span>),</span><br><span class="line">    CourseBefore <span class="type">VARCHAR</span>(<span class="number">15</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Demo.Choose (</span><br><span class="line">    ID <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">    CourseID <span class="type">VARCHAR</span>(<span class="number">30</span>),</span><br><span class="line">    Score <span class="type">DEC</span>(<span class="number">5</span>,<span class="number">2</span>),</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (ID, CourseID),</span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (ID) <span class="keyword">REFERENCES</span> Student(ID),</span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (CourseID) <span class="keyword">REFERENCES</span> Course(CourseID)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Demo.Student (ID, Name, Age, Department) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">&#x27;00001&#x27;</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;计算机系&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;00002&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;计算机系&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;00003&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>, <span class="number">21</span>, <span class="string">&#x27;计算机系&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Demo.Course (CourseID, CourseName, CourseBefore) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">&#x27;C1&#x27;</span>, <span class="string">&#x27;计算机引论&#x27;</span>, <span class="keyword">NULL</span>),</span><br><span class="line">(<span class="string">&#x27;C2&#x27;</span>, <span class="string">&#x27;PASCAL语言&#x27;</span>, <span class="string">&#x27;C1&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;C3&#x27;</span>, <span class="string">&#x27;数据结构&#x27;</span>, <span class="string">&#x27;C2&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Demo.Choose (ID, CourseID, Score) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">&#x27;00001&#x27;</span>, <span class="string">&#x27;C1&#x27;</span>, <span class="number">95</span>),</span><br><span class="line">(<span class="string">&#x27;00001&#x27;</span>, <span class="string">&#x27;C2&#x27;</span>, <span class="number">80</span>),</span><br><span class="line">(<span class="string">&#x27;00001&#x27;</span>, <span class="string">&#x27;C3&#x27;</span>, <span class="number">84</span>),</span><br><span class="line">(<span class="string">&#x27;00002&#x27;</span>, <span class="string">&#x27;C1&#x27;</span>, <span class="number">80</span>),</span><br><span class="line">(<span class="string">&#x27;00002&#x27;</span>, <span class="string">&#x27;C2&#x27;</span>, <span class="number">85</span>),</span><br><span class="line">(<span class="string">&#x27;00003&#x27;</span>, <span class="string">&#x27;C1&#x27;</span>, <span class="number">78</span>),</span><br><span class="line">(<span class="string">&#x27;00003&#x27;</span>, <span class="string">&#x27;C3&#x27;</span>, <span class="number">70</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> ID,Name <span class="keyword">from</span> Demo.Student <span class="keyword">where</span> Department<span class="operator">=</span><span class="string">&#x27;计算机系&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> Student.ID, Name, CourseName, Score <span class="keyword">FROM</span> Demo.Student,Demo.Course,Demo.Choose <span class="keyword">where</span> Student.ID<span class="operator">=</span>Choose.ID;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> ID,Score <span class="keyword">from</span> Demo.Choose <span class="keyword">where</span> Choose.CourseID<span class="operator">=</span>&quot;C1&quot; <span class="keyword">and</span> Score <span class="operator">&lt;</span> (<span class="keyword">select</span> Score <span class="keyword">from</span> Demo.Choose,Demo.Student <span class="keyword">where</span> Choose.ID<span class="operator">=</span>Student.ID <span class="keyword">and</span> Student.Name<span class="operator">=</span>&quot;张三&quot; <span class="keyword">and</span> Choose.CourseID<span class="operator">=</span>&quot;C1&quot;); </span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> Choose.ID <span class="keyword">from</span> Demo.Choose  </span><br><span class="line"><span class="keyword">where</span> Choose.CourseID<span class="operator">=</span>&quot;C2&quot; <span class="keyword">and</span> Choose.ID </span><br><span class="line"><span class="keyword">in</span> (<span class="keyword">select</span> Choose.ID <span class="keyword">from</span> Choose <span class="keyword">where</span> Choose.CourseID<span class="operator">=</span>&quot;C3&quot;); </span><br></pre></td></tr></table></figure>

<h3 id="实验七"><a href="#实验七" class="headerlink" title="实验七"></a>实验七</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> Demo.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;DCL&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">create</span> <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;DCL&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">insert</span> <span class="keyword">on</span> DCLDemo.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;DCL&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">delete</span> <span class="keyword">on</span> DCLDemo.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;DCL&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">update</span> <span class="keyword">on</span> DCLDemo.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;DCL&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> DCLDemo.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;DCL&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="keyword">revoke</span> <span class="keyword">all</span> privileges <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">from</span> <span class="string">&#x27;DCL&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="实验八"><a href="#实验八" class="headerlink" title="实验八"></a>实验八</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Demo.Exam (</span><br><span class="line">  id <span class="type">VARCHAR</span>(<span class="number">17</span>),</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">  sex <span class="type">VARCHAR</span>(<span class="number">2</span>),</span><br><span class="line">  age <span class="type">INT</span>,</span><br><span class="line">  score <span class="type">NUMERIC</span>(<span class="number">6</span>, <span class="number">2</span>),</span><br><span class="line">  address <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  memo <span class="type">VARCHAR</span>(<span class="number">100</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Demo.Exam (id, name, sex, age, score, address, memo) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">&#x27;A0001&#x27;</span>, <span class="string">&#x27;赵一&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="number">20</span>, <span class="number">580.00</span>, <span class="string">&#x27;重邮宿舍12-3-5&#x27;</span>, <span class="string">&#x27;学习委员&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;B0002&#x27;</span>, <span class="string">&#x27;钱二&#x27;</span>, <span class="string">&#x27;女&#x27;</span>, <span class="number">19</span>, <span class="number">540.00</span>, <span class="string">&#x27;南福苑5-2-9&#x27;</span>, <span class="string">&#x27;班长&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;C0003&#x27;</span>, <span class="string">&#x27;孙三&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="number">21</span>, <span class="number">555.50</span>, <span class="string">&#x27;学生新区21-5-15&#x27;</span>, <span class="string">&#x27;优秀共青团员&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;D0004&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="number">22</span>, <span class="number">480.00</span>, <span class="string">&#x27;重邮宿舍8-2-22&#x27;</span>, <span class="string">&#x27;暂无相关信息&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;E0005&#x27;</span>, <span class="string">&#x27;周五&#x27;</span>, <span class="string">&#x27;女&#x27;</span>, <span class="number">20</span>, <span class="number">495.50</span>, <span class="string">&#x27;学生新区23-4-8&#x27;</span>, <span class="string">&#x27;暂无相关信息&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;F0006&#x27;</span>, <span class="string">&#x27;吴六&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="number">19</span>, <span class="number">435.00</span>, <span class="string">&#x27;南福苑2-5-12&#x27;</span>, <span class="string">&#x27;暂无相关信息&#x27;</span>);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX IndexScore <span class="keyword">ON</span> Demo.Exam(score);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Demo.jm (</span><br><span class="line">  Jmbm <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  Jmhz <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  Jmbz <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (Jmbm)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Demo.zjm (</span><br><span class="line">  Zjmbm <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  Zjmhz <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  Jmbm <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  Zjmbz <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (Zjmbm),</span><br><span class="line">  <span class="keyword">FOREIGN</span> KEY (Jmbm) <span class="keyword">REFERENCES</span> jm(Jmbm)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Demo.dhshow (</span><br><span class="line">  Dhh <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  Sl1 <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  Sl3 <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  Sl39 <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  Sl40 <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (Dhh),</span><br><span class="line">  <span class="keyword">FOREIGN</span> KEY (Sl40) <span class="keyword">REFERENCES</span> zjm(Zjmbm)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Demo.jm (Jmbm, Jmhz, Jmbz) <span class="keyword">VALUES</span> (<span class="string">&#x27;J001&#x27;</span>, <span class="string">&#x27;拉萨局&#x27;</span>, <span class="string">&#x27;L&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Demo.jm (Jmbm, Jmhz, Jmbz) <span class="keyword">VALUES</span> (<span class="string">&#x27;J002&#x27;</span>, <span class="string">&#x27;阿里局&#x27;</span>, <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Demo.zjm (Zjmbm, Zjmhz, Jmbm, Zjmbz) <span class="keyword">VALUES</span> (<span class="string">&#x27;Z001&#x27;</span>, <span class="string">&#x27;拉萨子局&#x27;</span>, <span class="string">&#x27;J001&#x27;</span>, <span class="string">&#x27;L1&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Demo.zjm (Zjmbm, Zjmhz, Jmbm, Zjmbz) <span class="keyword">VALUES</span> (<span class="string">&#x27;Z002&#x27;</span>, <span class="string">&#x27;阿里子局&#x27;</span>, <span class="string">&#x27;J002&#x27;</span>, <span class="string">&#x27;A1&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Demo.dhshow (Dhh, Sl1, Sl3, Sl39, Sl40) <span class="keyword">VALUES</span> (<span class="string">&#x27;1234567890&#x27;</span>, <span class="number">100</span>, <span class="number">50</span>, <span class="string">&#x27;540100&#x27;</span>, <span class="string">&#x27;Z001&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Demo.dhshow (Dhh, Sl1, Sl3, Sl39, Sl40) <span class="keyword">VALUES</span> (<span class="string">&#x27;0987654321&#x27;</span>, <span class="number">200</span>, <span class="number">75</span>, <span class="string">&#x27;540100&#x27;</span>, <span class="string">&#x27;Z001&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Demo.dhshow (Dhh, Sl1, Sl3, Sl39, Sl40) <span class="keyword">VALUES</span> (<span class="string">&#x27;1122334455&#x27;</span>, <span class="number">0</span>, <span class="number">600</span>, <span class="string">&#x27;542500&#x27;</span>, <span class="string">&#x27;Z002&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Demo.dhshow (Dhh, Sl1, Sl3, Sl39, Sl40) <span class="keyword">VALUES</span> (<span class="string">&#x27;2233445566&#x27;</span>, <span class="number">150</span>, <span class="number">100</span>, <span class="string">&#x27;542500&#x27;</span>, <span class="string">&#x27;Z002&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(Sl1) <span class="keyword">AS</span> AvgLongDistanceCharge <span class="keyword">FROM</span> Demo.dhshow <span class="keyword">group</span> <span class="keyword">by</span> Sl39 <span class="keyword">having</span> Sl39 <span class="operator">=</span> <span class="string">&#x27;540100&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> Dhh <span class="keyword">FROM</span> Demo.dhshow <span class="keyword">WHERE</span> Sl39 <span class="operator">=</span> <span class="string">&#x27;542500&#x27;</span> <span class="keyword">AND</span> Sl3 <span class="operator">&gt;</span> <span class="number">1000</span> <span class="keyword">AND</span> Sl1 <span class="operator">&gt;</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>



<h2 id="综合实验：实现一个小型数据库管理系统"><a href="#综合实验：实现一个小型数据库管理系统" class="headerlink" title="综合实验：实现一个小型数据库管理系统"></a>综合实验：实现一个小型数据库管理系统</h2><h2 id="一、实验题目：员工管理系统"><a href="#一、实验题目：员工管理系统" class="headerlink" title="一、实验题目：员工管理系统"></a>一、实验题目：员工管理系统</h2><h2 id="二、实验环境"><a href="#二、实验环境" class="headerlink" title="二、实验环境"></a>二、实验环境</h2><ul>
<li>前端：Bootstrap，html，css</li>
<li>后端：Django，python</li>
<li>数据库：mysql</li>
</ul>
<h2 id="三、实验目的"><a href="#三、实验目的" class="headerlink" title="三、实验目的"></a>三、实验目的</h2><p>通过使用MySQL作为数据库存储，Python作为后端语言，以及Django作为Web框架，设计和实现一个员工管理系统，学习如何管理员工信息，包括添加、删除、修改和查询等功能。熟练掌握基于 B&#x2F;S 架构的数据库系统的设计和管理，通过使用Bootstrap、HTML和CSS，学习如何设计和实现用户友好的Web界面，包括布局、样式和交互设计，熟练使用Django框架，学习如何快速构建Web应用程序，包括URL映射、视图处理、模板渲染等，熟练使用Django的ORM访问数据库，熟练运用 MySQL 数据库。</p>
<h2 id="四、实验思路"><a href="#四、实验思路" class="headerlink" title="四、实验思路"></a>四、实验思路</h2><h3 id="1-需求分析"><a href="#1-需求分析" class="headerlink" title="1.需求分析"></a>1.需求分析</h3><p>以管理员用户身份从登陆界面进入数据库管理系统，实现对公司员工的增加、删除、修改、查询，以及公司部门、员工薪资、出勤情况的增加、删除、修改、查询。对于登陆用户，可以显示自己的基本信息以及修改密码和个人信息。</p>
<h3 id="2-E-R图"><a href="#2-E-R图" class="headerlink" title="2.E-R图"></a>2.E-R图</h3><p><img src="/imgs/ems_db/image-20240613233354418.png" alt="image-20240613233354418"></p>
<h2 id="五、实验步骤"><a href="#五、实验步骤" class="headerlink" title="五、实验步骤"></a>五、实验步骤</h2><h3 id="1-设计数据库"><a href="#1-设计数据库" class="headerlink" title="1.设计数据库"></a>1.设计数据库</h3><h4 id="数据库：employee-manage"><a href="#数据库：employee-manage" class="headerlink" title="数据库：employee_manage"></a>数据库：employee_manage</h4><h5 id="1-ems-employee数据表"><a href="#1-ems-employee数据表" class="headerlink" title="(1)ems_employee数据表"></a>(1)ems_employee数据表</h5><table>
<thead>
<tr>
<th align="center">主要字段名称</th>
<th align="center">数据类型</th>
<th align="center">长度</th>
<th align="center">主外键</th>
<th align="center">解释</th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td align="center">int</td>
<td align="center"></td>
<td align="center">P</td>
<td align="center">员工ID</td>
</tr>
<tr>
<td align="center">name</td>
<td align="center">varchar</td>
<td align="center">100</td>
<td align="center"></td>
<td align="center">姓名</td>
</tr>
<tr>
<td align="center">gender</td>
<td align="center">varchar</td>
<td align="center">1</td>
<td align="center"></td>
<td align="center">性别</td>
</tr>
<tr>
<td align="center">age</td>
<td align="center">varchar</td>
<td align="center">10</td>
<td align="center"></td>
<td align="center">年龄</td>
</tr>
<tr>
<td align="center">position</td>
<td align="center">varchar</td>
<td align="center">100</td>
<td align="center"></td>
<td align="center">职位</td>
</tr>
<tr>
<td align="center">department_name</td>
<td align="center">varchar</td>
<td align="center">100</td>
<td align="center"></td>
<td align="center">部门名</td>
</tr>
<tr>
<td align="center">total_salary</td>
<td align="center">decimal</td>
<td align="center">(10,2)</td>
<td align="center"></td>
<td align="center">总薪水</td>
</tr>
<tr>
<td align="center">phone</td>
<td align="center">varchar</td>
<td align="center">11</td>
<td align="center"></td>
<td align="center">电话</td>
</tr>
<tr>
<td align="center">email</td>
<td align="center">varchar</td>
<td align="center">128</td>
<td align="center"></td>
<td align="center">邮箱</td>
</tr>
<tr>
<td align="center">password</td>
<td align="center">varchar</td>
<td align="center">128</td>
<td align="center"></td>
<td align="center">密码</td>
</tr>
<tr>
<td align="center">is_admin</td>
<td align="center">tinyint</td>
<td align="center">1</td>
<td align="center"></td>
<td align="center">是否为管理员</td>
</tr>
</tbody></table>
<h5 id="（2）ems-department数据表"><a href="#（2）ems-department数据表" class="headerlink" title="（2）ems_department数据表"></a>（2）ems_department数据表</h5><table>
<thead>
<tr>
<th align="center">字段名称</th>
<th align="center">数据类型</th>
<th align="center">长度</th>
<th align="center">主外键</th>
<th align="center">解释</th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td align="center">int</td>
<td align="center"></td>
<td align="center">P</td>
<td align="center">部门号</td>
</tr>
<tr>
<td align="center">department_name</td>
<td align="center">varchar</td>
<td align="center">100</td>
<td align="center"></td>
<td align="center">部门名</td>
</tr>
<tr>
<td align="center">manager_id</td>
<td align="center">int</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">部门管理员ID</td>
</tr>
<tr>
<td align="center">manager_name</td>
<td align="center">varchar</td>
<td align="center">100</td>
<td align="center"></td>
<td align="center">部门管理员姓名</td>
</tr>
<tr>
<td align="center">description</td>
<td align="center">varchar</td>
<td align="center">100</td>
<td align="center"></td>
<td align="center">部门描述</td>
</tr>
<tr>
<td align="center">member_num</td>
<td align="center">int</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">部门人数</td>
</tr>
</tbody></table>
<h5 id="（3）ems-salary数据表"><a href="#（3）ems-salary数据表" class="headerlink" title="（3）ems_salary数据表"></a>（3）ems_salary数据表</h5><table>
<thead>
<tr>
<th align="center">字段名称</th>
<th align="center">数据类型</th>
<th align="center">长度</th>
<th align="center">主外键</th>
<th align="center">解释</th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td align="center">int</td>
<td align="center"></td>
<td align="center">P</td>
<td align="center">编号</td>
</tr>
<tr>
<td align="center">employee_id</td>
<td align="center">int</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">员工ID</td>
</tr>
<tr>
<td align="center">name</td>
<td align="center">varchar</td>
<td align="center">100</td>
<td align="center"></td>
<td align="center">姓名</td>
</tr>
<tr>
<td align="center">base_salary</td>
<td align="center">decimal</td>
<td align="center">(10,2)</td>
<td align="center"></td>
<td align="center">基本薪资</td>
</tr>
<tr>
<td align="center">bonus</td>
<td align="center">decimal</td>
<td align="center">(10,2)</td>
<td align="center"></td>
<td align="center">奖金&#x2F;罚金</td>
</tr>
<tr>
<td align="center">total_salary</td>
<td align="center">decimal</td>
<td align="center">(10,2)</td>
<td align="center"></td>
<td align="center">实发薪资</td>
</tr>
</tbody></table>
<h5 id="（4）ems-attendance数据表"><a href="#（4）ems-attendance数据表" class="headerlink" title="（4）ems_attendance数据表"></a>（4）ems_attendance数据表</h5><table>
<thead>
<tr>
<th align="center">字段名称</th>
<th align="center">数据类型</th>
<th align="center">长度</th>
<th align="center">主外键</th>
<th align="center">解释</th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td align="center">int</td>
<td align="center"></td>
<td align="center">P</td>
<td align="center">编号</td>
</tr>
<tr>
<td align="center">employee_id</td>
<td align="center">int</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">员工ID</td>
</tr>
<tr>
<td align="center">name</td>
<td align="center">varchar</td>
<td align="center">100</td>
<td align="center"></td>
<td align="center">姓名</td>
</tr>
<tr>
<td align="center">date</td>
<td align="center">date</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">日期</td>
</tr>
<tr>
<td align="center">attendance_status</td>
<td align="center">varchar</td>
<td align="center">10</td>
<td align="center"></td>
<td align="center">出勤状态</td>
</tr>
<tr>
<td align="center">work_hours</td>
<td align="center">decimal</td>
<td align="center">(5,2)</td>
<td align="center"></td>
<td align="center">工作时长</td>
</tr>
</tbody></table>
<h3 id="2-初始化数据库"><a href="#2-初始化数据库" class="headerlink" title="2.初始化数据库"></a>2.初始化数据库</h3><ul>
<li>在MySQL中运行ems.sql，建立数据库和数据表，主要内容如下：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE  IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `employee_manage` <span class="comment">/*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci */</span> <span class="comment">/*!80016 DEFAULT ENCRYPTION=&#x27;N&#x27; */</span>;</span><br><span class="line">USE `employee_manage`;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */</span>;</span><br><span class="line"><span class="comment">/*!50503 SET NAMES utf8 */</span>;</span><br><span class="line"><span class="comment">/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */</span>;</span><br><span class="line"><span class="comment">/*!40103 SET TIME_ZONE=&#x27;+00:00&#x27; */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=&#x27;NO_AUTO_VALUE_ON_ZERO&#x27; */</span>;</span><br><span class="line"><span class="comment">/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Table structure for table `ems_attendance`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ems_attendance`;</span><br><span class="line"><span class="comment">/*!40101 SET @saved_cs_client     = @@character_set_client */</span>;</span><br><span class="line"><span class="comment">/*!50503 SET character_set_client = utf8mb4 */</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ems_attendance` (</span><br><span class="line">  `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `<span class="type">date</span>` <span class="type">date</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `attendance_status` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `work_hours` <span class="type">decimal</span>(<span class="number">5</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `employee_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">8</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci;</span><br><span class="line"><span class="comment">/*!40101 SET character_set_client = @saved_cs_client */</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Table structure for table `ems_department`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ems_department`;</span><br><span class="line"><span class="comment">/*!40101 SET @saved_cs_client     = @@character_set_client */</span>;</span><br><span class="line"><span class="comment">/*!50503 SET character_set_client = utf8mb4 */</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ems_department` (</span><br><span class="line">  `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `department_name` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `description` longtext,</span><br><span class="line">  `manager_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `member_num` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `manager_name` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `department_name` (`department_name`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">4</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci;</span><br><span class="line"><span class="comment">/*!40101 SET character_set_client = @saved_cs_client */</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Table structure for table `ems_employee`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ems_employee`;</span><br><span class="line"><span class="comment">/*!40101 SET @saved_cs_client     = @@character_set_client */</span>;</span><br><span class="line"><span class="comment">/*!50503 SET character_set_client = utf8mb4 */</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ems_employee` (</span><br><span class="line">  `last_login` datetime(<span class="number">6</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `email` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `gender` <span class="type">varchar</span>(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `age` <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `position` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `department_name` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `total_salary` <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `phone` <span class="type">varchar</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `is_active` tinyint(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `is_staff` tinyint(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `is_admin` tinyint(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `is_superuser` tinyint(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `email` (`email`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">8</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci;</span><br><span class="line"><span class="comment">/*!40101 SET character_set_client = @saved_cs_client */</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Table structure for table `ems_salary`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ems_salary`;</span><br><span class="line"><span class="comment">/*!40101 SET @saved_cs_client     = @@character_set_client */</span>;</span><br><span class="line"><span class="comment">/*!50503 SET character_set_client = utf8mb4 */</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ems_salary` (</span><br><span class="line">  `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `base_salary` <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `bonus` <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `total_salary` <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `employee_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">8</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci;</span><br><span class="line"><span class="comment">/*!40101 SET character_set_client = @saved_cs_client */</span>;</span><br><span class="line"><span class="comment">/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40101 SET SQL_MODE=@OLD_SQL_MODE */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */</span>;</span><br><span class="line"><span class="comment">/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>也可通过在 Django 的 models.py 文件中设计模型，新建employee_manage数据库后通过在 Django 目录使用以下两条命令初始化数据表</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure>

<p>models.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> AbstractBaseUser, PermissionsMixin, BaseUserManager</span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="comment"># Create your models here.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EmployeeManager</span>(<span class="title class_ inherited__">BaseUserManager</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_user</span>(<span class="params">self, email, password=<span class="literal">None</span>, **extra_fields</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> email:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;The Email field must be set&#x27;</span>)</span><br><span class="line">        email = self.normalize_email(email)</span><br><span class="line">        user = self.model(email=email, **extra_fields)</span><br><span class="line">        user.set_password(password)</span><br><span class="line">        user.save()</span><br><span class="line">        <span class="keyword">return</span> user</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_superuser</span>(<span class="params">self, email, password=<span class="literal">None</span>, **extra_fields</span>):</span><br><span class="line">        extra_fields.setdefault(<span class="string">&#x27;is_superuser&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line">        extra_fields.setdefault(<span class="string">&#x27;is_admin&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line">        extra_fields.setdefault(<span class="string">&#x27;is_staff&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> self.create_user(email, password, **extra_fields)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 雇员模型</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span>(AbstractBaseUser, PermissionsMixin):</span><br><span class="line">    email = models.EmailField(max_length=<span class="number">128</span>, unique=<span class="literal">True</span>, default=<span class="string">&#x27;user@123.com&#x27;</span>)</span><br><span class="line">    password = models.CharField(max_length=<span class="number">128</span>, default=<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line">    GENDER_CHOICES = (</span><br><span class="line">        (<span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;男&#x27;</span>),</span><br><span class="line">        (<span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;女&#x27;</span>),</span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">id</span> = models.AutoField(primary_key=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;员工ID&#x27;</span>)</span><br><span class="line">    name = models.CharField(max_length=<span class="number">100</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;姓名&#x27;</span>)</span><br><span class="line">    gender = models.CharField(max_length=<span class="number">1</span>, choices=GENDER_CHOICES, null=<span class="literal">True</span>, blank=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;性别&#x27;</span>)</span><br><span class="line">    age = models.CharField(max_length=<span class="number">10</span>, verbose_name=<span class="string">&#x27;年龄&#x27;</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    position = models.CharField(max_length=<span class="number">100</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;职位&#x27;</span>)</span><br><span class="line">    department_name = models.CharField(max_length=<span class="number">100</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;部门&#x27;</span>)</span><br><span class="line">    total_salary = models.DecimalField(max_digits=<span class="number">10</span>, decimal_places=<span class="number">2</span>, verbose_name=<span class="string">&#x27;总薪资&#x27;</span>, blank=<span class="literal">True</span>, null=<span class="literal">True</span>)</span><br><span class="line">    phone = models.CharField(max_length=<span class="number">11</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;联系电话&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    is_active = models.BooleanField(default=<span class="literal">True</span>)</span><br><span class="line">    is_staff = models.BooleanField(default=<span class="literal">False</span>)</span><br><span class="line">    is_admin = models.BooleanField(default=<span class="literal">False</span>)</span><br><span class="line">    is_superuser = models.BooleanField(default=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    objects = EmployeeManager()</span><br><span class="line"></span><br><span class="line">    USERNAME_FIELD = <span class="string">&#x27;email&#x27;</span></span><br><span class="line">    REQUIRED_FIELDS = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.email</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">has_perm</span>(<span class="params">self, perm, obj=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="keyword">return</span> self.is_admin <span class="keyword">or</span> self.is_superuser</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">has_module_perms</span>(<span class="params">self, app_label</span>):</span><br><span class="line">        <span class="keyword">return</span> self.is_admin <span class="keyword">or</span> self.is_superuser</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 部门模型</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Department</span>(models.Model):</span><br><span class="line">    manager_id = models.IntegerField(null=<span class="literal">True</span>, blank=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;部门管理员ID&#x27;</span>)</span><br><span class="line">    manager_name = models.CharField(max_length=<span class="number">100</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;部门管理员&#x27;</span>)</span><br><span class="line">    department_name = models.CharField(max_length=<span class="number">100</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>, unique=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;部门&#x27;</span>)</span><br><span class="line">    member_num = models.IntegerField(null=<span class="literal">True</span>, blank=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;部门人数&#x27;</span>)</span><br><span class="line">    description = models.TextField(null=<span class="literal">True</span>, blank=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;部门描述&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.department_name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 薪水模型</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Salary</span>(models.Model):</span><br><span class="line">    employee_id = models.IntegerField(null=<span class="literal">True</span>, blank=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;员工ID&#x27;</span>)</span><br><span class="line">    name = models.CharField(max_length=<span class="number">100</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;姓名&#x27;</span>)</span><br><span class="line">    base_salary = models.DecimalField(max_digits=<span class="number">10</span>, decimal_places=<span class="number">2</span>, verbose_name=<span class="string">&#x27;基本工资&#x27;</span>)</span><br><span class="line">    bonus = models.DecimalField(max_digits=<span class="number">10</span>, decimal_places=<span class="number">2</span>, default=<span class="number">0</span>, verbose_name=<span class="string">&#x27;奖金&#x27;</span>)</span><br><span class="line">    total_salary = models.DecimalField(max_digits=<span class="number">10</span>, decimal_places=<span class="number">2</span>, verbose_name=<span class="string">&#x27;总薪资&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;Salary record for employee&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Attendance</span>(models.Model):</span><br><span class="line">    employee_id = models.IntegerField(null=<span class="literal">True</span>, blank=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;员工ID&#x27;</span>)</span><br><span class="line">    name = models.CharField(max_length=<span class="number">100</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;姓名&#x27;</span>)</span><br><span class="line">    date = models.DateField()</span><br><span class="line">    attendance_status = models.CharField(max_length=<span class="number">50</span>, choices=(</span><br><span class="line">        (<span class="string">&#x27;Present&#x27;</span>, <span class="string">&#x27;正常&#x27;</span>),</span><br><span class="line">        (<span class="string">&#x27;Late&#x27;</span>, <span class="string">&#x27;迟到&#x27;</span>),</span><br><span class="line">        (<span class="string">&#x27;Early&#x27;</span>, <span class="string">&#x27;早退&#x27;</span>),</span><br><span class="line">        (<span class="string">&#x27;Absent&#x27;</span>, <span class="string">&#x27;请假&#x27;</span>),</span><br><span class="line">        <span class="comment"># 更多出勤状态...</span></span><br><span class="line">    ))</span><br><span class="line">    work_hours = models.DecimalField(max_digits=<span class="number">5</span>, decimal_places=<span class="number">2</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<ul>
<li>在pycharm中用DB Browser将后端与数据库连接，在pycharm中的配置如下图</li>
</ul>
<p><img src="/imgs/ems_db/image-20240612110701188.png" alt="image-20240612110701188"></p>
<h3 id="3-后台程序管理设计"><a href="#3-后台程序管理设计" class="headerlink" title="3.后台程序管理设计"></a>3.后台程序管理设计</h3><h4 id="3-1索引页面"><a href="#3-1索引页面" class="headerlink" title="3.1索引页面"></a>3.1索引页面</h4><ul>
<li>用pycharm打开项目后进入Django目录，用python manage.py runserver启动服务，在浏览器输入127.0.0.1:8000进入索引界面，点击链接跳转到登录页面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240612114244155.png" alt="image-20240612114244155"></p>
<ul>
<li>路由在urls.py中</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path(<span class="string">&quot;&quot;</span>,views.index,name=<span class="string">&#x27;index&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>后端代码主要在views.py中</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h4 id="3-2登录页面"><a href="#3-2登录页面" class="headerlink" title="3.2登录页面"></a>3.2登录页面</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">管理员用户名：admin@123.com</span><br><span class="line">管理员密码：123456</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">普通用户名：user@wqw.com</span><br><span class="line">普通用户密码：123456</span><br></pre></td></tr></table></figure>

<ul>
<li>输入后成功跳转到主页</li>
</ul>
<p><img src="/imgs/ems_db/image-20240612114016388.png" alt="image-20240612114016388"></p>
<ul>
<li>urls.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path(<span class="string">&quot;login/&quot;</span>,views.user_login,name=<span class="string">&#x27;login&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>后端代码主要为views.py的user_login函数，对输入的用户名和密码进行验证并判断是否为管理员，用户名密码错误则报错，若为管理员则跳转到后台主页，若为普通用户则跳转到用户主页</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">user_login</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        email = request.POST[<span class="string">&#x27;email&#x27;</span>]</span><br><span class="line">        password = request.POST[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        user = authenticate(email=email, password=password)</span><br><span class="line">        <span class="keyword">if</span> user <span class="keyword">and</span> is_admin(user):</span><br><span class="line">            login(request, user)</span><br><span class="line">            request.session[<span class="string">&#x27;username&#x27;</span>] = email</span><br><span class="line">            <span class="keyword">return</span> redirect(<span class="string">&#x27;admin_home&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> user:</span><br><span class="line">            login(request, user)</span><br><span class="line">            request.session[<span class="string">&#x27;username&#x27;</span>] = email</span><br><span class="line">            <span class="keyword">return</span> redirect(reverse(<span class="string">&#x27;user_home&#x27;</span>, args=[user.<span class="built_in">id</span>]))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;login.html&#x27;</span>, &#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;Invalid credentials&#x27;</span>&#125;)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;login.html&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h4 id="3-3主页"><a href="#3-3主页" class="headerlink" title="3.3主页"></a>3.3主页</h4><h5 id="3-3-1用户主页"><a href="#3-3-1用户主页" class="headerlink" title="3.3.1用户主页"></a>3.3.1用户主页</h5><ul>
<li>在用户主页可以看到用户个人信息，可通过右上角折叠栏修改账号密码、退出登录，点击编辑可以跳转到编辑用户界面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240612205144560.png" alt="image-20240612205144560"></p>
<ul>
<li>在编辑用户界面可以修改用户密码以及个人信息等，成功编辑后会更新数据库中的用户记录并回到用户主页</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613162431081.png" alt="image-20240613162431081"></p>
<ul>
<li>修改账号密码，修改后会更新数据库中的用户记录并跳转到登录页面，需重新登录</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613162542062.png" alt="image-20240613162542062"></p>
<ul>
<li>urls.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">path(<span class="string">&quot;user_home/&lt;int:user_id&gt;/&quot;</span>,views.user_home,name=<span class="string">&#x27;user_home&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;user_home/&lt;int:user_id&gt;/edit/&quot;</span>, views.user_edit, name=<span class="string">&#x27;user_edit&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;admin_home/&lt;int:user_id&gt;/change_admin_password/&quot;</span>, views.change_admin_password, name=<span class="string">&#x27;change_admin_password&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>views.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用户主页</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_home</span>(<span class="params">request, user_id</span>):</span><br><span class="line">    user = Employee.objects.get(<span class="built_in">id</span>=user_id)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;user_home.html&#x27;</span>, &#123;<span class="string">&#x27;user&#x27;</span>: user&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#编辑用户</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_edit</span>(<span class="params">request, user_id</span>):</span><br><span class="line">    user = Employee.objects.get(<span class="built_in">id</span>=user_id)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="comment">#更新数据库中的记录</span></span><br><span class="line">        user.name = request.POST[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">        user.gender = request.POST[<span class="string">&#x27;gender&#x27;</span>]</span><br><span class="line">        user.age = request.POST[<span class="string">&#x27;age&#x27;</span>]</span><br><span class="line">        user.phone = request.POST[<span class="string">&#x27;phone&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> user.name <span class="keyword">or</span> <span class="keyword">not</span> user.gender <span class="keyword">or</span> <span class="keyword">not</span> user.age <span class="keyword">or</span> <span class="keyword">not</span> user.phone:</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;user_edit.html&#x27;</span>, &#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;有字段为空&#x27;</span>&#125;)</span><br><span class="line">        user.save()</span><br><span class="line">        <span class="keyword">return</span> redirect(reverse(<span class="string">&#x27;user_home&#x27;</span>, args=[user.<span class="built_in">id</span>]))</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;user_edit.html&#x27;</span>, &#123;<span class="string">&quot;user&quot;</span>: user&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#修改账号密码</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_user_password</span>(<span class="params">request, user_id</span>):</span><br><span class="line">    user = Employee.objects.get(<span class="built_in">id</span>=user_id)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="comment">#更新数据库中的记录</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> request.POST[<span class="string">&#x27;email&#x27;</span>] <span class="keyword">or</span> <span class="keyword">not</span> request.POST[<span class="string">&#x27;password&#x27;</span>]:</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;change_user_password.html&#x27;</span>, &#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;用户名或密码为空&#x27;</span>&#125;)</span><br><span class="line">        user.email = request.POST[<span class="string">&#x27;email&#x27;</span>]</span><br><span class="line">        user.password = request.POST[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        user.password = make_password(user.password)</span><br><span class="line">        user.save()</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&quot;login&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;change_user_password.html&#x27;</span>, &#123;<span class="string">&quot;user&quot;</span>: user&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="3-3-2后台主页"><a href="#3-3-2后台主页" class="headerlink" title="3.3.2后台主页"></a>3.3.2后台主页</h5><ul>
<li>后台主页中显示了管理员的相关信息，可修改管理员账号密码，也可点击编辑可修改管理员个人信息，还可跳转到对员工信息、公司部门信息、员工薪资、出勤情况的管理界面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613163214992.png" alt="image-20240613163214992"></p>
<ul>
<li>编辑管理员界面，成功编辑后更新数据库中的管理员记录并回到后台主页</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613164953458.png" alt="image-20240613164953458"></p>
<ul>
<li>修改管理员账号密码，修改后会更新数据库中的管理员记录并跳转到登录页面，需重新登录</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613165032891.png" alt="image-20240613165032891"></p>
<ul>
<li>urls.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">path(<span class="string">&quot;admin_home/&quot;</span>,views.admin_home,name=<span class="string">&#x27;admin_home&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;user_home/&lt;int:user_id&gt;/edit/&quot;</span>, views.user_edit, name=<span class="string">&#x27;user_edit&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;admin_home/&lt;int:user_id&gt;/change_admin_password/&quot;</span>, views.change_admin_password, name=<span class="string">&#x27;change_admin_password&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>views.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#后台主页</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin_home</span>(<span class="params">request</span>):</span><br><span class="line">    manager = Employee.objects.get(<span class="built_in">id</span>=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;admin_home.html&#x27;</span>, &#123;<span class="string">&#x27;manager&#x27;</span>: manager&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#编辑管理员信息</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin_edit</span>(<span class="params">request, employee_id</span>):</span><br><span class="line">    employee = get_object_or_404(Employee, <span class="built_in">id</span>=employee_id)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        <span class="comment">#更新数据库中的记录</span></span><br><span class="line">        employee.email = request.POST[<span class="string">&#x27;email&#x27;</span>]</span><br><span class="line">        employee.name = request.POST[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">        employee.password = request.POST[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        employee.password = make_password(employee.password)</span><br><span class="line">        employee.gender = request.POST[<span class="string">&#x27;gender&#x27;</span>]</span><br><span class="line">        employee.age = request.POST[<span class="string">&#x27;age&#x27;</span>]</span><br><span class="line">        employee.department_name = request.POST[<span class="string">&#x27;department&#x27;</span>]</span><br><span class="line">        employee.position = request.POST[<span class="string">&#x27;position&#x27;</span>]</span><br><span class="line">        employee.phone = request.POST[<span class="string">&#x27;phone&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">not</span> employee.email <span class="keyword">or</span> <span class="keyword">not</span> employee.password <span class="keyword">or</span> <span class="keyword">not</span> employee.name <span class="keyword">or</span> <span class="keyword">not</span> employee.gender <span class="keyword">or</span> <span class="keyword">not</span> employee.age</span><br><span class="line">                <span class="keyword">or</span> <span class="keyword">not</span> employee.position <span class="keyword">or</span> <span class="keyword">not</span> employee.phone <span class="keyword">or</span> <span class="keyword">not</span> employee.department_name):</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;admin_edit.html&#x27;</span>, &#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;所有字段都是必填的&#x27;</span>&#125;)</span><br><span class="line">        <span class="keyword">if</span> employee.department_name != request.POST[<span class="string">&#x27;department&#x27;</span>]:</span><br><span class="line">            employee.department_name = request.POST[<span class="string">&#x27;department&#x27;</span>]</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                department = Department.objects.get(manager_id=employee.<span class="built_in">id</span>)</span><br><span class="line">                <span class="keyword">if</span> department:</span><br><span class="line">                    department.manager_id = <span class="literal">None</span></span><br><span class="line">                    department.manager_name = <span class="literal">None</span></span><br><span class="line">                    department.save()</span><br><span class="line">            <span class="keyword">except</span> Department.DoesNotExist:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">        employee.save()</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;admin_home&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;admin_edit.html&#x27;</span>, &#123;<span class="string">&#x27;employee&#x27;</span>: employee&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#修改账号密码</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_admin_password</span>(<span class="params">request, user_id</span>):</span><br><span class="line">    manager = Employee.objects.get(<span class="built_in">id</span>=user_id)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="comment">#更新数据库中的记录</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> request.POST[<span class="string">&#x27;email&#x27;</span>] <span class="keyword">or</span> <span class="keyword">not</span> request.POST[<span class="string">&#x27;password&#x27;</span>]:</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;change_admin_password.html&#x27;</span>, &#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;用户名或密码为空&#x27;</span>&#125;)</span><br><span class="line">        manager.email = request.POST[<span class="string">&#x27;email&#x27;</span>]</span><br><span class="line">        manager.password = request.POST[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        manager.password = make_password(manager.password)</span><br><span class="line">        manager.save()</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&quot;login&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;change_admin_password.html&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h4 id="3-4员工管理"><a href="#3-4员工管理" class="headerlink" title="3.4员工管理"></a>3.4员工管理</h4><ul>
<li>在后台主页点击员工管理可跳转到员工管理界面，可对员工信息进行增加、删除、修改、查询</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613173220750.png" alt="image-20240613173220750"></p>
<ul>
<li>添加员工，输入员工信息，成功添加后会在数据库中添加相应记录并回到员工管理界面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613173240765.png" alt="image-20240613173240765"></p>
<ul>
<li>删除员工，通过输入员工ID选择要删除的员工，删除相应记录后回到员工管理界面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613173329956.png" alt="image-20240613173329956"></p>
<ul>
<li>修改员工信息，成功修改后会更新数据库中相应记录并回到员工管理界面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613173351330.png" alt="image-20240613173351330"></p>
<ul>
<li>查询员工，输入员工ID后，若相应的员工存在则显示相应的员工信息</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613173427367.png" alt="image-20240613173427367"></p>
<p><img src="/imgs/ems_db/image-20240613173947496.png" alt="image-20240613173947496"></p>
<ul>
<li>urls.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">path(<span class="string">&quot;employee_info/&quot;</span>,views.employee_info,name=<span class="string">&#x27;employee_info&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;employee_info/add/&quot;</span>,views.employee_add,name=<span class="string">&#x27;employee_add&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;employee_info/delete/&quot;</span>,views.employee_delete,name=<span class="string">&#x27;employee_delete&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;employee_info/&lt;int:employee_id&gt;/edit/&quot;</span>,views.employee_edit,name=<span class="string">&#x27;employee_edit&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;employee_info/search/&quot;</span>,views.employee_search,name=<span class="string">&#x27;employee_search&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;&lt;int:employee_id&gt;/info_list/&quot;</span>,views.info_list,name=<span class="string">&#x27;info_list&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>views.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#添加员工</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">employee_add</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        <span class="comment">#在数据库中添加记录</span></span><br><span class="line">        email = request.POST[<span class="string">&#x27;email&#x27;</span>]</span><br><span class="line">        password = request.POST[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        name = request.POST[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">        gender = request.POST[<span class="string">&#x27;gender&#x27;</span>]</span><br><span class="line">        age = request.POST[<span class="string">&#x27;age&#x27;</span>]</span><br><span class="line">        position = request.POST[<span class="string">&#x27;position&#x27;</span>]</span><br><span class="line">        department_name = request.POST[<span class="string">&#x27;department&#x27;</span>]</span><br><span class="line">        phone = request.POST[<span class="string">&#x27;phone&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> email <span class="keyword">or</span> <span class="keyword">not</span> name <span class="keyword">or</span> <span class="keyword">not</span> age <span class="keyword">or</span> <span class="keyword">not</span> position <span class="keyword">or</span> <span class="keyword">not</span> department_name <span class="keyword">or</span> <span class="keyword">not</span> phone <span class="keyword">or</span> <span class="keyword">not</span> password:</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;department_add.html&#x27;</span>, &#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;所有字段都是必填的&#x27;</span>&#125;)</span><br><span class="line">        employee = Employee(</span><br><span class="line">            email=email,</span><br><span class="line">            password=password,</span><br><span class="line">            name=name,</span><br><span class="line">            gender=gender,</span><br><span class="line">            age=age,</span><br><span class="line">            position=position,</span><br><span class="line">            department_name=department_name,</span><br><span class="line">            phone=phone</span><br><span class="line">        )</span><br><span class="line">        employee.password = make_password(employee.password)</span><br><span class="line">        employee.is_staff = <span class="literal">True</span></span><br><span class="line">        employee.save()</span><br><span class="line">        <span class="comment"># 重定向到员工信息页面</span></span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;employee_info&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;employee_add.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#删除员工</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">employee_delete</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        user_id = request.POST[<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span>(user_id == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;employee_delete.html&#x27;</span>, &#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;不能删除管理员&#x27;</span>&#125;)</span><br><span class="line">        employee = get_object_or_404(Employee, <span class="built_in">id</span>=user_id)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            department = Department.objects.get(manager_id=employee.<span class="built_in">id</span>)</span><br><span class="line">            <span class="keyword">if</span> department:</span><br><span class="line">                department.manager_id = <span class="literal">None</span></span><br><span class="line">                department.manager_name = <span class="literal">None</span></span><br><span class="line">                department.save()</span><br><span class="line">        <span class="keyword">except</span> Department.DoesNotExist:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        salaries = Salary.objects.<span class="built_in">filter</span>(employee_id=employee.<span class="built_in">id</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(salaries) &gt; <span class="number">0</span>:</span><br><span class="line">            salaries.delete()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        attendances = Attendance.objects.<span class="built_in">filter</span>(employee_id=employee.<span class="built_in">id</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(attendances) &gt; <span class="number">0</span>:</span><br><span class="line">            attendances.delete()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        employee.delete()</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;employee_info&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;employee_delete.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#编辑员工</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">employee_edit</span>(<span class="params">request, employee_id</span>):</span><br><span class="line">    employee = get_object_or_404(Employee, <span class="built_in">id</span>=employee_id)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        <span class="comment">#更新数据库中的记录</span></span><br><span class="line">        employee.email = request.POST[<span class="string">&#x27;email&#x27;</span>]</span><br><span class="line">        employee.password = request.POST[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        employee.password = make_password(employee.password)</span><br><span class="line">        employee.name = request.POST[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">        employee.gender = request.POST[<span class="string">&#x27;gender&#x27;</span>]</span><br><span class="line">        employee.age = request.POST[<span class="string">&#x27;age&#x27;</span>]</span><br><span class="line">        employee.department_name = request.POST[<span class="string">&#x27;department&#x27;</span>]</span><br><span class="line">        employee.position = request.POST[<span class="string">&#x27;position&#x27;</span>]</span><br><span class="line">        employee.phone = request.POST[<span class="string">&#x27;phone&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">not</span> employee.email <span class="keyword">or</span> <span class="keyword">not</span> employee.name <span class="keyword">or</span> <span class="keyword">not</span> employee.gender <span class="keyword">or</span> <span class="keyword">not</span> employee.age <span class="keyword">or</span> <span class="keyword">not</span> employee.position</span><br><span class="line">                <span class="keyword">or</span> <span class="keyword">not</span> employee.phone <span class="keyword">or</span> <span class="keyword">not</span> employee.department_name <span class="keyword">or</span> <span class="keyword">not</span> employee.password):</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;employee_edit.html&#x27;</span>, &#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;所有字段都是必填的&#x27;</span>&#125;)</span><br><span class="line">        <span class="keyword">if</span> employee.department_name != request.POST[<span class="string">&#x27;department&#x27;</span>]:</span><br><span class="line">            employee.department_name = request.POST[<span class="string">&#x27;department&#x27;</span>]</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                department = Department.objects.get(manager_id=employee.<span class="built_in">id</span>)</span><br><span class="line">                <span class="keyword">if</span> department:</span><br><span class="line">                    department.manager_id = <span class="literal">None</span></span><br><span class="line">                    department.manager_name = <span class="literal">None</span></span><br><span class="line">                    department.save()</span><br><span class="line">            <span class="keyword">except</span> Department.DoesNotExist:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">        employee.save()</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;employee_info&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;employee_edit.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#查找员工</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">employee_search</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        user_id = request.POST[<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">        employee = get_object_or_404(Employee, <span class="built_in">id</span>=user_id)</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;info_list&#x27;</span>, employee_id=employee.<span class="built_in">id</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;employee_search.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">info_list</span>(<span class="params">request, employee_id</span>):</span><br><span class="line">    employee = get_object_or_404(Employee, <span class="built_in">id</span>=employee_id)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;info_list.html&#x27;</span>, &#123;<span class="string">&#x27;employee&#x27;</span>: employee&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#员工管理界面</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">employee_info</span>(<span class="params">request</span>):</span><br><span class="line">    employees = Employee.objects.exclude(<span class="built_in">id</span>=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;employee_info.html&quot;</span>, &#123;<span class="string">&#x27;employees&#x27;</span>: employees&#125;)</span><br></pre></td></tr></table></figure>



<h4 id="3-5部门管理"><a href="#3-5部门管理" class="headerlink" title="3.5部门管理"></a>3.5部门管理</h4><ul>
<li>点击部门管理可跳转到部门管理界面，可对公司部门信息进行添加、删除、修改、查询</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613235007308.png" alt="image-20240613235007308"></p>
<ul>
<li>添加部门，添加成功后回到部门管理界面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613174409356.png" alt="image-20240613174409356"></p>
<ul>
<li>编辑部门，修改部门信息，成功修改后回到部门管理界面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613174436976.png" alt="image-20240613174436976"></p>
<ul>
<li>删除部门，输入部门ID删除部门，并将在这个部门的员工信息一起删除，删除成功回到部门管理界面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613174501381.png" alt="image-20240613174501381"></p>
<ul>
<li>查询部门，输入部门ID后，若相应的部门存在则显示相应的部门信息</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613174642070.png" alt="image-20240613174642070"></p>
<p><img src="/imgs/ems_db/image-20240613235031627.png" alt="image-20240613235031627"></p>
<ul>
<li>urls.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">path(<span class="string">&quot;department_info/&quot;</span>,views.department_info,name=<span class="string">&#x27;department_info&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;department_info/add/&quot;</span>,views.department_add,name=<span class="string">&#x27;department_add&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;department_info/delete/&quot;</span>,views.department_delete,name=<span class="string">&#x27;department_delete&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;department_info/&lt;int:department_id&gt;/edit/&quot;</span>,views.department_edit,name=<span class="string">&#x27;department_edit&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;department_info/search/&quot;</span>,views.department_search,name=<span class="string">&#x27;department_search&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;&lt;int:department_id&gt;/department_info_list/&quot;</span>, views.department_info_list, name=<span class="string">&#x27;department_info_list&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>views.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#部门管理界面</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">department_info</span>(<span class="params">request</span>):</span><br><span class="line">    departments = Department.objects.<span class="built_in">all</span>()</span><br><span class="line">    <span class="comment">#统计各部门人数并保存到数据库中</span></span><br><span class="line">    department_counts = Employee.objects.values(<span class="string">&#x27;department_name&#x27;</span>).annotate(count=Count(<span class="string">&#x27;department_name&#x27;</span>))</span><br><span class="line">    <span class="keyword">for</span> department_count <span class="keyword">in</span> department_counts:</span><br><span class="line">        <span class="keyword">for</span> department <span class="keyword">in</span> departments:</span><br><span class="line">            <span class="keyword">if</span> department_count[<span class="string">&#x27;department_name&#x27;</span>] == department.department_name:</span><br><span class="line">                department.member_num = department_count[<span class="string">&#x27;count&#x27;</span>]</span><br><span class="line">                department.save()</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;department_info.html&quot;</span>, &#123;<span class="string">&#x27;departments&#x27;</span>: departments&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#添加部门</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">department_add</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        <span class="comment">#在数据库中添加记录</span></span><br><span class="line">        manager_id = request.POST[<span class="string">&#x27;manager_id&#x27;</span>]</span><br><span class="line">        manager_name = request.POST[<span class="string">&#x27;manager&#x27;</span>]</span><br><span class="line">        department_name = request.POST[<span class="string">&#x27;department_name&#x27;</span>]</span><br><span class="line">        description = request.POST[<span class="string">&#x27;description&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> department_name <span class="keyword">or</span> <span class="keyword">not</span> manager_id <span class="keyword">or</span> <span class="keyword">not</span> manager_name:</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;department_add.html&#x27;</span>, &#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;除了部门描述外其他字段必填&#x27;</span>&#125;)</span><br><span class="line">        department = Department(</span><br><span class="line">            manager_id=manager_id,</span><br><span class="line">            manager_name=manager_name,</span><br><span class="line">            department_name=department_name,</span><br><span class="line">            description=description,</span><br><span class="line">        )</span><br><span class="line">        department.save()</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;department_info&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;department_add.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#删除部门</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">department_delete</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        department_id = request.POST[<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">        department = get_object_or_404(Department, <span class="built_in">id</span>=department_id)</span><br><span class="line">        employees = Employee.objects.<span class="built_in">filter</span>(department_name=department.department_name)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(employees) &gt; <span class="number">0</span>:</span><br><span class="line">            employees.delete()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        department.delete()</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;department_info&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;department_delete.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#编辑部门</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">department_edit</span>(<span class="params">request, department_id</span>):</span><br><span class="line">    department = get_object_or_404(Department, <span class="built_in">id</span>=department_id)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        <span class="comment">#更新数据库中的记录</span></span><br><span class="line">        department.manager_id = request.POST[<span class="string">&#x27;manager_id&#x27;</span>]</span><br><span class="line">        department.manager_name = request.POST[<span class="string">&#x27;manager_name&#x27;</span>]</span><br><span class="line">        department.department_name = request.POST[<span class="string">&#x27;department_name&#x27;</span>]</span><br><span class="line">        department.description = request.POST[<span class="string">&#x27;description&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> department.manager_id <span class="keyword">or</span> <span class="keyword">not</span> department.manager_name <span class="keyword">or</span> <span class="keyword">not</span> department.department_name:</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;department_add.html&#x27;</span>, &#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;除了部门描述外其他字段必填&#x27;</span>&#125;)</span><br><span class="line">        department.save()</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;department_info&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;department_edit.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#查询部门</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">department_search</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        department_id = request.POST[<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">        department = get_object_or_404(Department, <span class="built_in">id</span>=department_id)</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;department_info_list&#x27;</span>, department_id=department.<span class="built_in">id</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;department_search.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">department_info_list</span>(<span class="params">request, department_id</span>):</span><br><span class="line">    department = get_object_or_404(Department, <span class="built_in">id</span>=department_id)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;department_info_list.html&#x27;</span>, &#123;<span class="string">&#x27;department&#x27;</span>: department&#125;)</span><br></pre></td></tr></table></figure>



<h4 id="3-6薪资管理"><a href="#3-6薪资管理" class="headerlink" title="3.6薪资管理"></a>3.6薪资管理</h4><ul>
<li>点击员工薪资后可跳转到薪资管理界面，可对员工薪资信息进行添加、删除、修改、查询</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613190114779.png" alt="image-20240613190114779"></p>
<ul>
<li>添加记录，添加成功后回到薪资管理界面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613190300937.png" alt="image-20240613190300937"></p>
<ul>
<li>删除记录，输入记录编号，删除成功后回到薪资管理界面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613190934248.png" alt="image-20240613190934248"></p>
<ul>
<li>编辑记录，编辑完成后回到薪资管理界面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613191138300.png" alt="image-20240613191138300"></p>
<ul>
<li>查询记录，输入记录编号，若记录存在则显示相应记录信息</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613191259838.png" alt="image-20240613191259838"></p>
<ul>
<li>urls.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">path(<span class="string">&quot;salary_info/&quot;</span>,views.salary_info,name=<span class="string">&#x27;salary_info&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;salary_info/add/&quot;</span>,views.salary_add,name=<span class="string">&#x27;salary_add&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;salary_info/delete/&quot;</span>,views.salary_delete,name=<span class="string">&#x27;salary_delete&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;salary_info/search/&quot;</span>,views.salary_search,name=<span class="string">&#x27;salary_search&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;&lt;int:salary_employee_id&gt;/salary_info_list/&quot;</span>, views.salary_info_list, name=<span class="string">&#x27;salary_info_list&#x27;</span>),</span><br><span class="line">path(<span class="string">&quot;salary_info/&lt;int:salary_id&gt;/edit/&quot;</span>,views.salary_edit,name=<span class="string">&#x27;salary_edit&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>views.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#薪资管理界面</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">salary_info</span>(<span class="params">request</span>):</span><br><span class="line">    salaries = Salary.objects.<span class="built_in">all</span>()</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;salary_info.html&quot;</span>, &#123;<span class="string">&#x27;salaries&#x27;</span>: salaries&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#添加薪资记录</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">salary_add</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        <span class="comment">#在数据库中添加记录</span></span><br><span class="line">        employee_id = request.POST[<span class="string">&#x27;employee_id&#x27;</span>]</span><br><span class="line">        employee_name = request.POST[<span class="string">&#x27;employee_name&#x27;</span>]</span><br><span class="line">        base_salary = request.POST[<span class="string">&#x27;base_salary&#x27;</span>]</span><br><span class="line">        bonus = request.POST[<span class="string">&#x27;bonus&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> employee_id <span class="keyword">or</span> <span class="keyword">not</span> employee_name <span class="keyword">or</span> <span class="keyword">not</span> base_salary:</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;department_add.html&#x27;</span>, &#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;除了奖金外其他字段必填&#x27;</span>&#125;)</span><br><span class="line">        total_salary = <span class="built_in">float</span>(bonus) + <span class="built_in">float</span>(base_salary)</span><br><span class="line">        salary = Salary(</span><br><span class="line">            employee_id=employee_id,</span><br><span class="line">            name=employee_name,</span><br><span class="line">            base_salary=base_salary,</span><br><span class="line">            bonus=bonus,</span><br><span class="line">            total_salary=total_salary</span><br><span class="line">        )</span><br><span class="line">        salary.save()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            employee = Employee.objects.get(<span class="built_in">id</span>=employee_id)</span><br><span class="line">            <span class="keyword">if</span> employee:</span><br><span class="line">                employee.total_salary = total_salary</span><br><span class="line">                employee.save()</span><br><span class="line">        <span class="keyword">except</span> Employee.DoesNotExist:</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;salary_add.html&#x27;</span>, &#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;员工不存在&#x27;</span>&#125;)</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;salary_info&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;salary_add.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#删除记录</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">salary_delete</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        employee_id = request.POST[<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">        salaries = Salary.objects.<span class="built_in">filter</span>(employee_id=employee_id)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(salaries) &gt; <span class="number">0</span>:</span><br><span class="line">            salaries.delete()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;salary_delete.html&#x27;</span>, &#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;无薪资记录&#x27;</span>&#125;)</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;salary_info&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;salary_delete.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#查询记录</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">salary_search</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        employee_id = request.POST[<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">        salaries = Salary.objects.<span class="built_in">filter</span>(employee_id=employee_id)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            salary = salaries.first()</span><br><span class="line">        <span class="keyword">except</span> Salary.DoesNotExist:</span><br><span class="line">            salary = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;salary_info_list&#x27;</span>, salary_employee_id=salary.employee_id)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;salary_search.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">salary_info_list</span>(<span class="params">request, salary_employee_id</span>):</span><br><span class="line">    salaries = Salary.objects.<span class="built_in">filter</span>(employee_id=salary_employee_id)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;salary_info_list.html&#x27;</span>, &#123;<span class="string">&#x27;salaries&#x27;</span>: salaries&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#编辑记录</span></span><br><span class="line"><span class="meta">@user_passes_test(<span class="params">is_admin</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">salary_edit</span>(<span class="params">request, salary_id</span>):</span><br><span class="line">    salary = Salary.objects.get(<span class="built_in">id</span>=salary_id)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        <span class="comment">#更新数据库中记录</span></span><br><span class="line">        salary.employee_id = request.POST[<span class="string">&#x27;employee_id&#x27;</span>]</span><br><span class="line">        salary.name = request.POST[<span class="string">&#x27;employee_name&#x27;</span>]</span><br><span class="line">        salary.base_salary = request.POST[<span class="string">&#x27;base_salary&#x27;</span>]</span><br><span class="line">        salary.bonus = request.POST[<span class="string">&#x27;bonus&#x27;</span>]</span><br><span class="line">        salary.total_salary = <span class="built_in">float</span>(salary.base_salary) + <span class="built_in">float</span>(salary.bonus)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> salary.base_salary <span class="keyword">or</span> <span class="keyword">not</span> salary.name <span class="keyword">or</span> <span class="keyword">not</span> salary.employee_id:</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;salary_edit.html&#x27;</span>, &#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;有的字段不能为空&#x27;</span>&#125;)</span><br><span class="line">        salary.save()</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;salary_info&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;salary_edit.html&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h4 id="3-7考勤管理"><a href="#3-7考勤管理" class="headerlink" title="3.7考勤管理"></a>3.7考勤管理</h4><ul>
<li>点击出勤情况会跳转到考勤管理界面，可对员工出勤情况进行添加、删除、修改、查询</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613195234865.png" alt="image-20240613195234865"></p>
<ul>
<li>添加出勤记录，添加成功后回到出勤情况界面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613195320102.png" alt="image-20240613195320102"></p>
<ul>
<li>删除出勤记录，输入员工ID，成功删除后回到出勤情况界面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613195637888.png" alt="image-20240613195637888"></p>
<ul>
<li>编辑出勤记录，编辑成功后回到出勤情况界面</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613195720481.png" alt="image-20240613195720481"></p>
<ul>
<li>查询出勤记录，输入员工ID，若员工存在则显示相应记录信息</li>
</ul>
<p><img src="/imgs/ems_db/image-20240613195920494.png" alt="image-20240613195920494"></p>
<p><img src="/imgs/ems_db/image-20240613195930933.png" alt="image-20240613195930933"></p>
<h4 id="前端网页界面设计"><a href="#前端网页界面设计" class="headerlink" title="前端网页界面设计"></a>前端网页界面设计</h4><ul>
<li>index.html—索引界面</li>
<li>login.html—登录界面<ul>
<li>my-login.css—登录界面样式</li>
</ul>
</li>
<li>user_home.html—用户主页</li>
<li>user_edit.html—编辑用户界面</li>
<li>change_user_password.html—修改用户账号密码界面</li>
<li>admin_home.html—后台主页</li>
<li>admin_edit.html—编辑管理员界面</li>
<li>change_admin_password.html—修改管理员账号密码界面</li>
<li>employee_info.html—员工管理界面</li>
<li>employee_add.html—添加员工界面</li>
<li>employee_delete.html—删除员工界面</li>
<li>employee_edit.html—编辑员工界面</li>
<li>employee_search.html—查找员工界面</li>
<li>info_list.html—显示查找的员工信息界面</li>
<li>department_info.html—部门管理界面</li>
<li>department_add.html—添加部门界面</li>
<li>department_delete.html—删除部门界面</li>
<li>department_edit.html—编辑部门界面</li>
<li>department_search.html—查找部门界面</li>
<li>department_info_list.html—显示要查找的部门信息界面</li>
<li>salary_info.html—薪资管理界面</li>
<li>salary_add.html—添加薪资记录界面</li>
<li>salary_delete.html—删除薪资记录界面</li>
<li>salary_edit.html—编辑薪资记录界面</li>
<li>salary_search.html—查找薪资记录界面</li>
<li>salary_info_list.html—显示要查找的薪资记录界面</li>
<li>attendance_info.html—出勤管理界面</li>
<li>attendance_add.html—添加出勤记录界面</li>
<li>attendance_delete.html—删除出勤记录界面</li>
<li>attendance_edit.html—编辑出勤记录界面</li>
<li>attendance_search.html—查找出勤记录界面</li>
<li>attendance_info_list—显示查找的出勤记录界面</li>
</ul>
<h2 id="六、实验心得"><a href="#六、实验心得" class="headerlink" title="六、实验心得"></a>六、实验心得</h2><p>本次数据库课程设计让我对数据库管理系统的开发有了更深入的理解和实践，通过使用 MySQL、Python 和 Django，我成功地设计和实现了一个简单的员工管理系统，包括员工信息、部门信息、薪资信息和考勤情况的添加、删除、修改、查找功能。这次实验让我体会到 Django 是一个功能强大的 Web 框架，它提供了许多内置功能，例如用户认证、数据库 ORM、模板系统等，这让我能够更快地开发系统，并减少代码量。在前端展示上，我使用了 Bootstrap 框架来设计用户界面，它提供了丰富的样式和组件，让我能够快速构建美观且易用的界面。当然，在开发过程中，我遇到很多问题，比如用户认证、权限管理、数据关联等，通过上网查阅资料，我最终解决了这些问题，积累了很多开发经验。总而言之，此次课程设计带给我很多收获，为以后对数据库管理系统的进一步学习打下基础。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://yiweibu.github.io">Wei</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://yiweibu.github.io/2024/08/06/ems_db/">http://yiweibu.github.io/2024/08/06/ems_db/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yiweibu.github.io" target="_blank">Wei's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/sql/">sql</a></div><div class="post_share"><div class="social-share" data-image="/imgs/tx.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/03/19/WINSTAR_WN572HP3/" title="Missing check for malloc size in upload.cgi of WINSTAR_WN572HP3 Device"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Missing check for malloc size in upload.cgi of WINSTAR_WN572HP3 Device</div></div></a></div><div class="next-post pull-right"><a href="/2024/08/06/xv6_lab/" title="xv6-lab"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">xv6-lab</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/imgs/tx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Wei</div><div class="author-info__description">麻雀虽小，五脏俱全；菜鸟虽菜，越学越菜</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A"><span class="toc-number">1.</span> <span class="toc-text">数据库实验报告</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E5%AE%9E%E9%AA%8C%EF%BC%9ASQL%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">1.1.</span> <span class="toc-text">小实验：SQL基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%B8%80%EF%BC%9A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83"><span class="toc-number">1.1.1.</span> <span class="toc-text">实验一：搭建环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%BA%8C"><span class="toc-number">1.1.2.</span> <span class="toc-text">实验二</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%B8%89"><span class="toc-number">1.1.3.</span> <span class="toc-text">实验三</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%9B%9B"><span class="toc-number">1.1.4.</span> <span class="toc-text">实验四</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%BA%94"><span class="toc-number">1.1.5.</span> <span class="toc-text">实验五</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%85%AD"><span class="toc-number">1.1.6.</span> <span class="toc-text">实验六</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%B8%83"><span class="toc-number">1.1.7.</span> <span class="toc-text">实验七</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%85%AB"><span class="toc-number">1.1.8.</span> <span class="toc-text">实验八</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%B0%8F%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.2.</span> <span class="toc-text">综合实验：实现一个小型数据库管理系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%AE%9E%E9%AA%8C%E9%A2%98%E7%9B%AE%EF%BC%9A%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.3.</span> <span class="toc-text">一、实验题目：员工管理系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83"><span class="toc-number">1.4.</span> <span class="toc-text">二、实验环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84"><span class="toc-number">1.5.</span> <span class="toc-text">三、实验目的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%AE%9E%E9%AA%8C%E6%80%9D%E8%B7%AF"><span class="toc-number">1.6.</span> <span class="toc-text">四、实验思路</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-number">1.6.1.</span> <span class="toc-text">1.需求分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-E-R%E5%9B%BE"><span class="toc-number">1.6.2.</span> <span class="toc-text">2.E-R图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.7.</span> <span class="toc-text">五、实验步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.7.1.</span> <span class="toc-text">1.设计数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%9Aemployee-manage"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">数据库：employee_manage</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-ems-employee%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-number">1.7.1.1.1.</span> <span class="toc-text">(1)ems_employee数据表</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%882%EF%BC%89ems-department%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-number">1.7.1.1.2.</span> <span class="toc-text">（2）ems_department数据表</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%883%EF%BC%89ems-salary%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-number">1.7.1.1.3.</span> <span class="toc-text">（3）ems_salary数据表</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%884%EF%BC%89ems-attendance%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-number">1.7.1.1.4.</span> <span class="toc-text">（4）ems_attendance数据表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%9D%E5%A7%8B%E5%8C%96%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.7.2.</span> <span class="toc-text">2.初始化数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%90%8E%E5%8F%B0%E7%A8%8B%E5%BA%8F%E7%AE%A1%E7%90%86%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.7.3.</span> <span class="toc-text">3.后台程序管理设计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1%E7%B4%A2%E5%BC%95%E9%A1%B5%E9%9D%A2"><span class="toc-number">1.7.3.1.</span> <span class="toc-text">3.1索引页面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2"><span class="toc-number">1.7.3.2.</span> <span class="toc-text">3.2登录页面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3%E4%B8%BB%E9%A1%B5"><span class="toc-number">1.7.3.3.</span> <span class="toc-text">3.3主页</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3-1%E7%94%A8%E6%88%B7%E4%B8%BB%E9%A1%B5"><span class="toc-number">1.7.3.3.1.</span> <span class="toc-text">3.3.1用户主页</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3-2%E5%90%8E%E5%8F%B0%E4%B8%BB%E9%A1%B5"><span class="toc-number">1.7.3.3.2.</span> <span class="toc-text">3.3.2后台主页</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86"><span class="toc-number">1.7.3.4.</span> <span class="toc-text">3.4员工管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5%E9%83%A8%E9%97%A8%E7%AE%A1%E7%90%86"><span class="toc-number">1.7.3.5.</span> <span class="toc-text">3.5部门管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6%E8%96%AA%E8%B5%84%E7%AE%A1%E7%90%86"><span class="toc-number">1.7.3.6.</span> <span class="toc-text">3.6薪资管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7%E8%80%83%E5%8B%A4%E7%AE%A1%E7%90%86"><span class="toc-number">1.7.3.7.</span> <span class="toc-text">3.7考勤管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E7%BD%91%E9%A1%B5%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.7.3.8.</span> <span class="toc-text">前端网页界面设计</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%AE%9E%E9%AA%8C%E5%BF%83%E5%BE%97"><span class="toc-number">1.8.</span> <span class="toc-text">六、实验心得</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/28/Wavlink-WL-WN579A3-RCE/" title="Remote Command Execute in wireless.cgi of Wavlink-WL-WN579A3">Remote Command Execute in wireless.cgi of Wavlink-WL-WN579A3</a><time datetime="2025-03-27T16:00:00.000Z" title="发表于 2025-03-28 00:00:00">2025-03-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/27/Wavlink-WL-WN579A3-StackOverflow/" title="Wavlink-WL-WN579A3-StackOverflow in upload.cgi">Wavlink-WL-WN579A3-StackOverflow in upload.cgi</a><time datetime="2025-03-26T16:00:00.000Z" title="发表于 2025-03-27 00:00:00">2025-03-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/19/WINSTAR_WN572HP3/" title="Missing check for malloc size in upload.cgi of WINSTAR_WN572HP3 Device">Missing check for malloc size in upload.cgi of WINSTAR_WN572HP3 Device</a><time datetime="2025-03-18T16:00:00.000Z" title="发表于 2025-03-19 00:00:00">2025-03-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/06/ems_db/" title="数据库课程设计">数据库课程设计</a><time datetime="2024-08-05T16:00:00.000Z" title="发表于 2024-08-06 00:00:00">2024-08-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/06/xv6_lab/" title="xv6-lab">xv6-lab</a><time datetime="2024-08-05T16:00:00.000Z" title="发表于 2024-08-06 00:00:00">2024-08-06</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Wei</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>